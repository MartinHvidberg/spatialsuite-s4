/*
 Better Autocomplete v1.0-dev
 https://github.com/betamos/Better-Autocomplete

 Copyright 2011, Didrik Nordstrï¿½m, http://betamos.se/
 Dual licensed under the MIT or GPL Version 2 licenses.

*/
(function(a){a.fn.betterAutocomplete=function(c){var d={init:function(c,d,e){var f=a(this);c=new b(f,c,d,e);f.data("better-autocomplete",c);c.enable()},enable:function(a){a.enable()},disable:function(a){a.disable()},destroy:function(a){a.destroy()}},f=Array.prototype.slice.call(arguments,1);this.each(function(){switch(c){case "init":d[c].apply(this,f);break;case "enable":case "disable":case "destroy":var h=a(this).data("better-autocomplete");h instanceof b&&d[c].call(this,h);break;default:a.error(["Method",
c,"does not exist in jQuery.betterAutocomplete."].join(" "))}});return this};var b=function(b,c,f,h){function l(c){if(!("object"==a.type(c)&&"keyup"==c.type&&0<=a.inArray(c.keyCode,[38,40]))){var d=h.canonicalQuery(b.val(),f.caseSensitive);clearTimeout(q);q=null;v();d.length>=f.charLimit&&(!a.isArray(p[d])&&-1==a.inArray(d,s))&&(j.empty(),k?A(d):q=setTimeout(function(){A(d);q=null},f.delay))}}var m="",p={},r=[],u=0,q,s=[],t=!1,n={},k="string"!=a.type(c),j=a("\x3cul /\x3e").addClass("better-autocomplete"),
x=!0,w=null;f=a.extend({charLimit:k?1:3,delay:350,caseSensitive:!1,cacheLimit:k?0:256,remoteTimeout:1E4,crossOrigin:!1,selectKeys:[9,13],autoHighlight:!0},f);h=a.extend({},d,h);h.insertSuggestionList(j,b);n.focus=function(){w||v(!0)};n.blur=function(){w?b.focus():v()};n.keydown=function(b){var c=z();if(0<=a.inArray(b.keyCode,[38,40])&&0<j.children().length){var d,e=a(".result",j).length;switch(b.keyCode){case 38:d=Math.max(0,c-1);break;case 40:d=Math.min(e-1,c+1)}t=!0;y(d,"key",!0);return!1}if(0<=
a.inArray(b.keyCode,f.selectKeys)&&!b.shiftKey&&!b.ctrlKey&&!b.altKey&&!b.metaKey)return B(),9==b.keyCode};n.keyup=n.click=l;j.delegate(".result",{mouseenter:function(){t||y(a(".result",j).index(a(this)),"mouse")},mousemove:function(){t=!1},mousedown:function(){B();return!1}});j.mousedown(function(){clearTimeout(w);w=setTimeout(function(){w=null},50);return!1});j.mouseleave(function(){f.autoHighlight||y(-1)});this.enable=function(){b.attr("autocomplete","OFF").attr("aria-autocomplete","list");b.bind(n)};
this.disable=function(){b.removeAttr("autocomplete").removeAttr("aria-autocomplete");j.hide();b.unbind(n)};this.destroy=function(){j.remove();b.unbind(n);b.removeData("better-autocomplete")};this.doSearch=function(a){b.focus();p={};r=[];u=0;this.setInputText(a);l(null)};this.repeatSearch=function(){b.focus();p={};r=[];u=0;l(null)};this.setInputText=function(a){var c=a.indexOf("\x3cselect\x3e");if(-1<c){var d=a.indexOf("\x3c/select\x3e");if(-1<c){var f=d-c-8;a=a.substring(0,c)+a.substring(c+8,d)+a.substring(d+
9);b.val(a);b.caret(c,c+f)}}else b.val(a)};var C=function(a,b){for(u+=b.length;u>f.cacheLimit&&r.length;){var c=r.shift();u-=p[c].length;delete p[c]}r.push(a);p[a]=b},y=function(c,d,f){var g=z(),m=a(".result",j);m.removeClass("highlight");if(!(0>c)){m.eq(c).addClass("highlight");if(g!=c){var r=D(c);h.highlight(r.data("result"),b,d)}d=0==c||c<g;c=m.eq(c);f&&(c.prev().is(".group")&&d&&(c=c.prev()),0>c.position().top?j.scrollTop(c.position().top+j.scrollTop()):c.position().top+c.outerHeight()>j.height()&&
j.scrollTop(c.position().top+j.scrollTop()+c.outerHeight()-j.height()))}},z=function(){var b=a(".result.highlight",j);return a(".result",j).index(b)},D=function(b){b=a(".result",j).eq(b);if(b.length)return b},B=function(){var a=z(),a=D(a);h.select(a.data("result"),b)},A=function(d){if(k)C(d,h.queryLocalResults(d,c,f.caseSensitive)),v();else{s.push(d);var m=h.constructURL(c,d);h.beginFetching(b);h.fetchRemoteData(m,function(c){c=h.processRemoteData(c);a.isArray(c)||(c=[]);C(d,c);s=a.grep(s,function(a){return a!=
d});s.length||h.finishFetching(b);v()},f.remoteTimeout,f.crossOrigin)}},v=function(c){var d=h.canonicalQuery(b.val(),f.caseSensitive);if(a.isArray(p[d])){if(m!==d){m=d;d=p[d];j.empty();var g={};0==d.length&&j.append("Ingen resultater");a.each(d,function(b,c){if("object"==a.type(c)){var d=h.themeResult(c);if(null!=d){if("string"==a.type(d))d=jQuery(d);else if(!(d instanceof jQuery))return;var e=h.getGroup(c);if("string"==a.type(e)&&!g[e]){var f=a("\x3cli /\x3e").addClass("group").append(a("\x3ch3 /\x3e").html(e)).appendTo(j);
g[e]=f}d=a("\x3cli /\x3e").addClass("result").append(d).data("result",c).addClass(c.addClass);"string"!=a.type(e)&&!j.children().first().is(".result")?j.prepend(d):(e="string"==a.type(e)?g[e]:j.children().first(),f=e.nextUntil(".group").last(),d.insertAfter(f.length?f:e))}}});f.autoHighlight&&0<a(".result",j).length&&y(0,"auto")}}else m=null,j.empty();(b.is(":focus")||c)&&!j.is(":empty")?(h.show(j),j.scrollTop(j.data("scroll-top"))):j.is(":visible")&&(h.hide(j),j.data("scroll-top",j.scrollTop()))};
this.show=function(){j.filter(":hidden").show();x&&(x=!1,h.afterShow(j))};this.hide=function(){j.hide();x||(x=!0,h.afterHide(j))}},d={select:function(a,b){b.val(a.title)},highlight:function(){},themeResult:function(b){var c=[];"string"==a.type(b.title)&&c.push("\x3ch4\x3e",b.title,"\x3c/h4\x3e");"string"==a.type(b.description)&&c.push("\x3cp\x3e",b.description,"\x3c/p\x3e");return c.join("")},queryLocalResults:function(b,c,d){if(!a.isArray(c))return[];var h=[];a.each(c,function(c,g){switch(a.type(g)){case "string":0<=
(d?g:g.toLowerCase()).indexOf(b)&&h.push({title:g});break;case "object":"string"==a.type(g.title)&&0<=(d?g.title:g.title.toLowerCase()).indexOf(b)?h.push(g):"string"==a.type(g.description)&&0<=(d?g.description:g.description.toLowerCase()).indexOf(b)&&h.push(g)}});return h},fetchRemoteData:function(b,c,d,h){a.ajax({url:b,dataType:h&&!a.support.cors?"jsonp":"json",timeout:d,success:function(a){c(a)},error:function(){c()}})},processRemoteData:function(b){return a.isArray(b)?b:[]},getGroup:function(b){if("string"==
a.type(b.group))return b.group},beginFetching:function(a){a.addClass("fetching")},finishFetching:function(a){a.removeClass("fetching")},show:function(a){this.show(a)},hide:function(a){this.hide(a)},afterShow:function(){},afterHide:function(){},constructURL:function(a,b){return a+(-1<a.indexOf("?")?"\x26":"?")+"q\x3d"+encodeURIComponent(b)},canonicalQuery:function(b,c){var d=a.trim(b);c||(d=d.toLowerCase());return d},insertSuggestionList:function(a,b){a.width(b.outerWidth()-2).css({position:"absolute",
left:b.position().left,top:b.position().top+b.outerHeight(),zIndex:10,maxHeight:"330px",boxShadow:"0 0 15px rgba(0, 0, 0, 0.5)"}).hide().insertAfter(b)}},c=a.expr[":"];c.focus||(c.focus=function(a){return a===document.activeElement&&(a.type||a.href)})})(jQuery);(function(a,b,d,c){a.fn.caret=function(e,g){var f,h,l=this[0],m=a.browser.msie;"object"===typeof e&&"number"===typeof e.start&&"number"===typeof e.end?(f=e.start,h=e.end):"number"===typeof e&&"number"===typeof g?(f=e,h=g):"string"===typeof e?-1<(f=l.value.indexOf(e))?h=f+e[b]:f=null:"[object RegExp]"===Object.prototype.toString.call(e)&&(e=e.exec(l.value),null!=e&&(f=e.index,h=f+e[0][b]));if("undefined"!=typeof f)return m?(m=this[0].createTextRange(),m.collapse(!0),m.moveStart("character",f),m.moveEnd("character",
h-f),m.select()):(this[0].selectionStart=f,this[0].selectionEnd=h),this[0].focus(),this;if(m)if(h=document.selection,"textarea"!=this[0].tagName.toLowerCase()){m=this.val();f=h[d]()[c]();f.moveEnd("character",m[b]);var p=""==f.text?m[b]:m.lastIndexOf(f.text);f=h[d]()[c]();f.moveStart("character",-m[b]);var r=f.text[b]}else f=h[d](),h=f[c](),h.moveToElementText(this[0]),h.setEndPoint("EndToEnd",f),p=h.text[b]-f.text[b],r=p+f.text[b];else p=l.selectionStart,r=l.selectionEnd;f=l.value.substring(p,r);
return{start:p,end:r,text:f,replace:function(a){return l.value.substring(0,p)+a+l.value.substring(r,l.value[b])}}}})(jQuery,"length","createRange","duplicate");"object"!==typeof window.JSON&&(window.JSON={});
(function(){function a(a){return 10>a?"0"+a:a}function b(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=h[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function d(a,c){var e,h,q,s,t=g,n,k=c[a];k&&("object"===typeof k&&"function"===typeof k.toJSON)&&(k=k.toJSON(a));"function"===typeof l&&(k=l.call(c,a,k));switch(typeof k){case "string":return b(k);case "number":return isFinite(k)?String(k):"null";case "boolean":case "null":return String(k);
case "object":if(!k)return"null";g+=f;n=[];if("[object Array]"===Object.prototype.toString.apply(k)){s=k.length;for(e=0;e<s;e+=1)n[e]=d(e,k)||"null";q=0===n.length?"[]":g?"[\n"+g+n.join(",\n"+g)+"\n"+t+"]":"["+n.join(",")+"]";g=t;return q}if(l&&"object"===typeof l){s=l.length;for(e=0;e<s;e+=1)"string"===typeof l[e]&&(h=l[e],(q=d(h,k))&&n.push(b(h)+(g?": ":":")+q))}else for(h in k)Object.prototype.hasOwnProperty.call(k,h)&&(q=d(h,k))&&n.push(b(h)+(g?": ":":")+q);q=0===n.length?"{}":g?"{\n"+g+n.join(",\n"+
g)+"\n"+t+"}":"{"+n.join(",")+"}";g=t;return q}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,f,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof window.JSON.stringify&&(window.JSON.stringify=function(a,b,c){var e;f=g="";if("number"===typeof c)for(e=0;e<c;e+=1)f+=" ";else"string"===typeof c&&(f=c);if((l=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return d("",
{"":a})});"function"!==typeof window.JSON.parse&&(window.JSON.parse=function(a,b){function d(a,c){var e,f,g=a[c];if(g&&"object"===typeof g)for(e in g)Object.prototype.hasOwnProperty.call(g,e)&&(f=d(g,e),void 0!==f?g[e]=f:delete g[e]);return b.call(a,c,g)}var e;a=String(a);c.lastIndex=0;c.test(a)&&(a=a.replace(c,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof b?d({"":e},""):e;throw new SyntaxError("JSON.parse");})})();var Septima=void 0!=window.Septima?window.Septima:{Class:function(){var a=arguments.length,b=arguments[0],d=arguments[a-1],c="function"==typeof d.initialize?d.initialize:function(){b.apply(this,arguments)};1<a?(a=[c,b].concat(Array.prototype.slice.call(arguments).slice(1,a-1),d),Septima.inherit.apply(null,a)):c.prototype=d;return c},bind:function(a,b){var d=Array.prototype.slice.apply(arguments,[2]);return function(){var c=d.concat(Array.prototype.slice.apply(arguments,[0]));return a.apply(b,c)}},
extend:function(a,b){a=a||{};if(b){for(var d in b){var c=b[d];void 0!==c&&(a[d]=c)}!("function"==typeof window.Event&&b instanceof window.Event)&&(b.hasOwnProperty&&b.hasOwnProperty("toString"))&&(a.toString=b.toString)}return a},inherit:function(a,b){var d=function(){};d.prototype=b.prototype;a.prototype=new d;var c,e,d=2;for(c=arguments.length;d<c;d++)e=arguments[d],"function"===typeof e&&(e=e.prototype),Septima.extend(a.prototype,e)}};Septima.Search={};Septima.Search.Controller=function(a,b,d){this.searcherRegs=a;this.searchers=[];for(a=0;a<this.searcherRegs.length;a++)this.searcherRegs[a].searcher.title=this.searcherRegs[a].title,this.searchers.push(this.searcherRegs[a].searcher);this.view=b;this.targettingResult=this.activeDataFetcher=null;this.onErrorHandlers=[Septima.bind(this.view.error,this.view)];null!=d&&jQuery.isFunction(d.onError)&&this.addErrorHandler(d.onError)};
Septima.Search.Controller.prototype.go=function(){this.view.initialize(this.searchers,{fetchDataHandler:Septima.bind(this.fetchData,this),onSelectHandler:Septima.bind(this.select,this)})};Septima.Search.Controller.prototype.addErrorHandler=function(a){this.onErrorHandlers.push(a)};Septima.Search.Controller.prototype.fetchData=function(a,b,d,c){a=Septima.Search.Query.Builder().queryString(a).limit(d).timeout(c).type("list").build();this.fetchDataFromQueryObject(a,b)};
Septima.Search.Controller.prototype.fetchDataCallback=function(a,b){if(a===this.activeDataFetcher){if(jQuery.isFunction(a.completeCallback)){a.completeCallback(b.getAllResults());var d=a.getQuery();d.hasTarget||this.addSearcherSuggestions(b,d.queryString);this.view.setSuggestions(null,b.getSuggestions())}else this.view.setResults(b.getResults());this.activeDataFetcher=null}};
Septima.Search.Controller.prototype.addSearcherSuggestions=function(a,b){for(var d=0;d<this.searchers.length;d++){var c=this.searchers[d].title;""!=c&&0==c.toLowerCase().indexOf(b.toLowerCase())&&a.addSuggestion(c,c+":")}};Septima.Search.Controller.prototype.selectedSearcherChange=function(){this.targettingResult=null};
Septima.Search.Controller.prototype.fetchDataFromQueryObject=function(a,b){null!=this.activeDataFetcher&&(this.activeDataFetcher.cancel(),this.activeDataFetcher=null);var d=[],c=Septima.Search.Query.Builder().copy(a),e=this.getSearchersFromQuery(a),d=0<e.length?d.concat(e):d.concat(this.searchers),c=1==d.length?c.type("list.force").limit(50):c.type("list").limit(Math.round(a.limit/d.length)),c=c.build();this.activeDataFetcher=new Septima.Search.DataFetcher(this,d);null!=b&&jQuery.isFunction(b)&&(this.activeDataFetcher.completeCallback=
b);this.activeDataFetcher.fetch(c)};Septima.Search.Controller.prototype.select=function(a){var b=a.searcher;if(a.hasOwnProperty("newquery")&&null!=a.newquery)-1==a.newquery.indexOf(":")?a.hasOwnProperty("newquerytest")&&null!=a.newquerytest?(this.targettingResult=a,this.view.doTextSearch(a.newquery)):this.view.doTextSearch(b.title.toLowerCase()+": "+a.newquery):this.view.doTextSearch(a.newquery),jQuery.isFunction(b.onSelect)&&setTimeout(Septima.bind(function(){this.onSelect(a)},b),250);else if(jQuery.isFunction(b.onSelect))b.onSelect(a)};
Septima.Search.Controller.prototype.setSearchText=function(a){this.view.doTextSearch(a)};
Septima.Search.Controller.prototype.getSearchersFromQuery=function(a){var b=[];if(null!=this.targettingResult){if(this.targettingResult.hasOwnProperty("newquerytest")&&0<this.targettingResult.newquerytest.length&&0==a.queryString.toLowerCase().indexOf(this.targettingResult.newquerytest.toLowerCase()))return b.push(this.targettingResult.searcher),b;this.targettingResult=null}if(a.hasTarget){a=a.target.toLowerCase();for(var d=0;d<this.searchers.length;d++)(this.searchers[d].hasTarget(a)||a.toLowerCase()==
this.searchers[d].title.toLowerCase())&&b.push(this.searchers[d])}return b};Septima.Search.Controller.prototype.getSearcherFromId=function(a){for(var b=0;b<this.searchers.length;b++)if(this.searchers[b].getId()==a)return this.searchers[b];return null};Septima.Search.Controller.prototype.fetchError=function(a,b,d){if(a===this.activeDataFetcher)for(a=0;a<this.onErrorHandlers.length;a++)this.onErrorHandlers[a](b,d)};Septima.Search.DefaultView=function(a,b){if(void 0==b||void 0==b.input)throw"New Septima.Search.DefaultView(options): Options.input is missing.";this.options=b;this.container=jQuery("#"+b.input);this.placeHolderText="S\u00f8g";void 0!=b.placeholder&&(this.placeHolderText=b.placeholder);this.limit=15;void 0!=b.limit&&(this.limit=b.limit);this.bac;this.visibleInterests=[];this.advancedIsVisible=this.isVisible=!1;this.fixedDisplayText=this.fixedDisplayHideFunction=this.fixedDisplay=this.header=this.$suggestionList=
this.$suggestionContainer=this.$gui=null;this.hasFixedDisplay=!1;this.fetchDataHandler=this.onSelectHandler=this.targetLabel=this.targetBit=this.myInputField=null};Septima.Search.DefaultView.prototype.blur=function(a){document.getElementById("mysearchbox").blur();a&&this.hideGui()};
Septima.Search.DefaultView.prototype.initialize=function(a,b){if(void 0==b)throw"New Septima.Search.DefaultView.initialize(searchers, options): Options is missing.";if(void 0==b.onSelectHandler)throw"New Septima.Search.DefaultView.initialize(searchers, options): onSelectHandler is missing.";this.onSelectHandler=b.onSelectHandler;if(void 0==b.fetchDataHandler)throw"New Septima.Search.DefaultView.initialize(searchers, options): fetchDataHandler is missing.";this.fetchDataHandler=b.fetchDataHandler;
this.$gui=this.createGui(this.container,a);this.myInputField.betterAutocomplete("init","http://bla.bla.",{cacheLimit:0,selectKeys:[13],crossOrigin:!0,charLimit:1},{fetchRemoteData:Septima.bind(this.fetchRemoteData,this),themeResult:Septima.bind(this.themeResult,this),insertSuggestionList:Septima.bind(this.insertSuggestionList,this),constructURL:Septima.bind(this.constructURL,this),select:Septima.bind(this.select,this),show:Septima.bind(this.bacEventShow,this),hide:Septima.bind(this.bacEventHide,this)});
this.bac=this.myInputField.data("better-autocomplete");this.myInputField.bind({focus:Septima.bind(this.inputEventsFocus,this),blur:Septima.bind(this.inputEventsBlur,this)})};Septima.Search.DefaultView.prototype.constructURL=function(a,b){return b};Septima.Search.DefaultView.prototype.insertSuggestionList=function(a){this.resultscontainer.append(a)};
Septima.Search.DefaultView.prototype.closeFixedText=function(){this.fixedDisplay.hide();this.fixedDisplayHideFunction();this.header.show();this.hasFixedDisplay=!1;this.evaluateVisibleInterest()};Septima.Search.DefaultView.prototype.showFixedText=function(a,b){this.header.hide();this.fixedDisplayText.html(a);this.fixedDisplay.show();this.hasFixedDisplay=!0;this.evaluateVisibleInterest();this.fixedDisplayHideFunction=b};
Septima.Search.DefaultView.prototype.removeTarget=function(){this.targetLabel.html("");this.targetBit.hide();this.myInputField.width(this.header.innerWidth()-45)};Septima.Search.DefaultView.prototype.showTarget=function(a){this.targetLabel.html(a);this.targetBit.show();this.myInputField.width(this.header.innerWidth()-this.targetBit.outerWidth()-45)};Septima.Search.DefaultView.prototype.completeQueryWithTarget=function(a){var b=a;""!=this.targetLabel.html()&&(b=this.targetLabel.html()+":"+a);return b};
Septima.Search.DefaultView.prototype.createGui=function(a){a.addClass("inputcontainer");this.header=jQuery('\x3cdiv class\x3d"searchheader"/\x3e');var b=jQuery('\x3cdiv class\x3d"searchbackground"\x3e\x3c/div\x3e');this.targetBit=jQuery("\x3cspan class\x3d'targetbit'\x3e\x3c/span\x3e");this.targetLabel=jQuery("\x3cspan class\x3d'targetlabel'\x3e\x3c/span\x3e");var d=jQuery("\x3cspan class\x3d'targetclosebutton'\x3eX\x3c/span\x3e");d.click(Septima.bind(function(){this.removeTarget();this.bac.repeatSearch()},
this));this.targetBit.append(this.targetLabel);this.targetBit.append(d);this.myInputField=jQuery('\x3cinput id\x3d"mysearchbox" class\x3d"search" placeholder\x3d"'+this.placeHolderText+'" autocomplete\x3d"off" role\x3d"textbox" aria-autocomplete\x3d"list" aria-haspopup\x3d"true"\x3e');b.append(this.targetBit);b.append(this.myInputField);this.header.append(b);b=jQuery('\x3cdiv class\x3d"searchmenu"\x3e\x3c/div\x3e');this.$suggestionList=jQuery('\x3cdiv class\x3d"suggestions"\x3e\x3c/div\x3e');b.append(this.$suggestionList);
this.header.append(b);this.fixedDisplay=jQuery('\x3cdiv class\x3d"fixeddisplay"/\x3e');this.fixedDisplayText=jQuery("\x3cspan\x3e\x3c/span\x3e");this.fixedDisplay.append(this.fixedDisplayText);b=jQuery('\x3cspan class\x3d"closebutton"\x3e\x3c/span\x3e');b.click(Septima.bind(this.closeFixedText,this));this.fixedDisplay.append(b);this.fixedDisplay.hide();this.resultscontainer=jQuery('\x3cdiv class\x3d"searchresult"/\x3e');a.append(this.header);a.append(this.fixedDisplay);a.append(this.resultscontainer);
a.bind({mouseenter:Septima.bind(this.guiEventMouseEnter,this),mouseleave:Septima.bind(this.guiEventMouseLeave,this)});this.myInputField.bind({mouseenter:Septima.bind(this.inputwrapperEventMouseEnter,this),mouseleave:Septima.bind(this.inputwrapperEventMouseLeave,this)});this.removeTarget()};
Septima.Search.DefaultView.prototype.fetchRemoteData=function(a,b,d){this.$suggestionList.empty();a=this.completeQueryWithTarget(a);this.fetchDataHandler(a,Septima.bind(function(a,b){a(b);0==b.length&&this.resultscontainer.children().empty()},this,b),this.limit,d)};Septima.Search.DefaultView.prototype.themeResult=function(a){return Septima.Search.ThemeResult(a)};Septima.Search.DefaultView.prototype.select=function(a){return this.onSelectHandler(a)};
Septima.Search.DefaultView.prototype.doTextSearch=function(a){this.$suggestionList.empty();-1<a.indexOf(":")?(a=a.split(":"),this.showTarget(a[0]),this.bac.doSearch(a[1])):(this.removeTarget(),this.bac.doSearch(a))};Septima.Search.DefaultView.prototype.setSuggestions=function(a,b){if(0<b.length)for(var d=0;d<b.length;d++){var c=b[d];jQuery('\x3cspan class\x3d"button"\x3e'+c.title+"\x3c/span\x3e").appendTo(this.$suggestionList).click(Septima.bind(function(a){this.doTextSearch(a)},this,c.newquery))}};
Septima.Search.DefaultView.prototype.setResults=function(a){this.bac.renderResults(a)};Septima.Search.DefaultView.prototype.error=function(){};
Septima.Search.DefaultView.prototype.setVisibleInterest=function(a,b){for(var d=!1,c=0;c<this.visibleInterests.length;c++)this.visibleInterests[c].party==a&&(d=!0,this.visibleInterests[c].interested=b);d||this.visibleInterests.push({party:a,interested:b});if(b&&!this.hasFixedDisplay)this.showGui();else{d=!1;for(c=0;c<this.visibleInterests.length;c++)this.visibleInterests[c].interested&&(d=!0);d&&!this.hasFixedDisplay?this.showGui():setTimeout(Septima.bind(this.evaluateVisibleInterest,this),200)}};
Septima.Search.DefaultView.prototype.evaluateVisibleInterest=function(){var a=!1;if(!this.hasFixedDisplay)for(var b=0;b<this.visibleInterests.length;b++)this.visibleInterests[b].interested&&(a=!0);a?this.showGui():this.hideGui()};Septima.Search.DefaultView.prototype.showGui=function(){this.isVisible||(this.container.addClass("active"),jQuery(".searchheader").addClass("active"),jQuery(".searchmenu").show(),this.resultscontainer.show(),this.isVisible=!0)};
Septima.Search.DefaultView.prototype.hideGui=function(){this.isVisible&&(this.container.removeClass("active"),jQuery(".searchheader").removeClass("active"),jQuery(".searchmenu").hide(),this.resultscontainer.hide(),this.isVisible=!1)};Septima.Search.DefaultView.prototype.inputwrapperEventMouseEnter=function(){this.setVisibleInterest("inputwrapper",!0)};Septima.Search.DefaultView.prototype.inputwrapperEventMouseLeave=function(){this.setVisibleInterest("inputwrapper",!1)};
Septima.Search.DefaultView.prototype.guiEventMouseEnter=function(){this.setVisibleInterest("gui",!0)};Septima.Search.DefaultView.prototype.guiEventMouseLeave=function(){this.setVisibleInterest("gui",!1)};Septima.Search.DefaultView.prototype.inputEventsFocus=function(){this.setVisibleInterest("input",!0)};Septima.Search.DefaultView.prototype.inputEventsBlur=function(){this.setVisibleInterest("input",!1)};
Septima.Search.DefaultView.prototype.bacEventShow=function(){this.setVisibleInterest("bac",!0);this.resultscontainer.show();this.bac.show()};Septima.Search.DefaultView.prototype.bacEventHide=function(){this.setVisibleInterest("bac",!1)};Septima.Search.Query=function(){this.type=this.timeout=this.limit=this.geometry=this.target=this.hasTarget=this.queryString=this.fullQuery=null};Septima.Search.Query.Builder=function(){return new Septima.Search.QueryBuilder};Septima.Search.Query.prototype.equals=function(a){return this.queryString==a.queryString&&this.target==a.target&&this.limit==a.limit&&this.timeout==a.timeout?!0:!1};
Septima.Search.QueryBuilder=function(){this._queryString="";this._limit=this._geometry=null;this._timeout=1E4;this._type=null};Septima.Search.QueryBuilder.prototype.copy=function(a){this._queryString=a.fullQuery;this._geometry=a.geometry;this._limit=a.limit;this._timeout=a.timeout;this._type=a.type;return this};
Septima.Search.QueryBuilder.prototype.build=function(){if(null==this._limit||null==this._type)throw"Invalid Query parameters";var a=new Septima.Search.Query,b=this._queryString.indexOf(":");a.hasTarget=0<b;a.hasTarget?(a.target=this._queryString.substring(0,b),a.queryString=this._queryString.replace(a.target+":","").trim(),a.fullQuery=a.target+":"+a.queryString):(a.target=null,a.queryString=this._queryString.trim(),a.fullQuery=this._queryString.trim());a.geometry=this._geometry;a.limit=this._limit;
a.timeout=this._timeout;a.type=this._type;return a};Septima.Search.QueryBuilder.prototype.queryString=function(a){this._queryString=a;return this};Septima.Search.QueryBuilder.prototype.geometry=function(a){this._geometry=a;return this};Septima.Search.QueryBuilder.prototype.limit=function(a){this._limit=a;return this};Septima.Search.QueryBuilder.prototype.timeout=function(a){this._timeout=a;return this};Septima.Search.QueryBuilder.prototype.type=function(a){this._type=a;return this};Septima.Search.QueryResult=Septima.Class({_searcher:null,_results:null,_newQueries:null,_suggestions:null,initialize:function(a){this._searcher=a;this._results=[];this._newQueries=[];this._suggestions=[]},addResult:function(a,b,d,c){a={title:a,description:b,geometry:d,data:c,searcher:this._searcher};this._results.push(a);return a},addResults:function(a){for(var b=0;b<a.length;b++)this._results.push(a[b])},addSuggestion:function(a,b){this._suggestions.push({title:a,newquery:b,searcher:this._searcher})},
addSuggestions:function(a){for(var b=0;b<a.length;b++)this._suggestions.push(a[b])},addNewQuery:function(a,b,d,c,e,g){d={title:a,description:b,newquery:d,geometry:c,data:e,searcher:this._searcher,newquerytest:void 0==g||null==g||""==g?null:g};this._newQueries.push(d);return d},addNewQueries:function(a){for(var b=0;b<a.length;b++)this._newQueries.push(a[b])},getSearcher:function(){return this._searcher},getNewQueries:function(){return this._newQueries},getResults:function(){return this._results},getAllResults:function(){return this._newQueries.concat(this._results)},
getSuggestions:function(){return this._suggestions},CLASS_NAME:"Septima.Search.QueryResult"});Septima.Search.DataFetcher=function(a,b){this.controller=a;this.queryResult=new Septima.Search.QueryResult(null);this.searchers=b;this._isActive=!0;this.onCancelHandlers=[];this.searcherStates=[];for(var d=0;d<this.searchers.length;d++)this.searcherStates.push({searcherId:this.searchers[d].getId(),state:"pending"});this.allResults=[];this.query=null};Septima.Search.DataFetcher.prototype.fetch=function(a){this.query=a;for(var b=0;b<this.searchers.length;b++)this.searchers[b].fetchData(a,this)};
Septima.Search.DataFetcher.prototype.getQuery=function(){return this.query};Septima.Search.DataFetcher.prototype.registerOnCancelHandler=function(a){this.onCancelHandlers.push(a)};Septima.Search.DataFetcher.prototype.cancel=function(){for(var a=0;a<this.onCancelHandlers.length;a++)this.onCancelHandlers[a]();this.clean()};Septima.Search.DataFetcher.prototype.clean=function(){this._isActive&&(this._isActive=!1,this.controller=null,this.onCancelHandlers=[],this.searcherStates=[],this.allResults=[])};
Septima.Search.DataFetcher.prototype.fetchSuccess=function(a){if(this._isActive){for(var b=a.getSearcher().getId(),d=0;d<this.searcherStates.length;d++)this.searcherStates[d].searcherId==b&&(this.searcherStates[d].state="complete",this.queryResult.addNewQueries(a.getNewQueries()),this.queryResult.addResults(a.getResults()),this.queryResult.addSuggestions(a.getSuggestions()));for(d=0;d<this.searcherStates.length;d++)if("pending"==this.searcherStates[d].state)return;this.controller.fetchDataCallback(this,
this.queryResult);this.clean()}};Septima.Search.DataFetcher.prototype.isActive=function(){return this._isActive};
Septima.Search.DataFetcher.prototype.fetchError=function(a,b){if(this._isActive){for(var d=a.getId(),c=0;c<this.searcherStates.length;c++)this.searcherStates[c].searcherId==d&&(this.searcherStates[c].state="error");this.controller.fetchError(this,a,b);for(c=0;c<this.searcherStates.length;c++)if("pending"==this.searcherStates[c].state)return;this.controller.fetchDataCallback(this,this.queryResult);this.clean()}};Septima.Search.ResultList=function(a){if(void 0==a||void 0==a.container)throw"New Septima.Search.ResultList(options): Options.container is missing.";a.onSelect&&(this.onSelect=a.onSelect);this.container=jQuery("#"+a.container);this.hasHeader=!1;this.header=null;a.hasheader&&(this.hasHeader=!0,this.header=jQuery('\x3cdiv style\x3d"background-color: blue;color:white;"\x3e\x3c/div\x3e'),this.container.append(this.header));this.resultList=jQuery("\x3cul /\x3e").addClass("better-autocomplete");this.container.append(this.resultList);
this.hasFooter=!1;this.clearIcon=null;a.hasfooter&&(this.hasFooter=!0,this.clearIcon=jQuery('\x3cimg src\x3d"images/edit-clear-list.png" class\x3d"clearicon"/\x3e'),this.clearIcon.css({display:"none"}),this.container.append(this.clearIcon),this.clearIcon.click(Septima.bind(function(){this.clear();this.clearIcon.css({display:"none"})},this)));this.resultList.on("mouseenter",".result",this,function(a){var d=jQuery(".result",a.data.resultList).index($(this));a=jQuery(".result",a.data.resultList);a.removeClass("highlight");
0>d||a.eq(d).addClass("highlight")});this.resultList.on("mouseout",".result",this,function(a){jQuery(".result .highlight",a.data.resultList).removeClass("highlight")});this.resultList.on("mousedown",".result",this,function(a){var d=$(".result",a.data.resultList).index($(this)),c=$(".result",a.data.resultList).eq(d).data("result");if(a.data.onSelect)a.data.onSelect(c);a=$(".result",a.data.resultList);a.removeClass("selected");a.eq(d).addClass("selected");return!1})};
Septima.Search.ResultList.prototype.clear=function(){this.resultList.empty();this.setHeader("")};Septima.Search.ResultList.prototype.setHeader=function(a){this.hasHeader&&this.header.html(a)};
Septima.Search.ResultList.prototype.addResult=function(a){var b=$("\x3cli /\x3e").addClass("result"),d=Septima.Search.ThemeResult(a);b.append(d);b.data("result",a);b.addClass(a.addClass);this.resultList.prepend(b);a=$(".result",this.resultList);a.removeClass("highlight");a.removeClass("selected");b.addClass("selected");this.hasFooter&&this.clearIcon.css({display:"inline"})};Septima.Search.ThemeResult=function(a){var b=a.searcher;if(jQuery.isFunction(b.themeResult))return b.themeResult(a);var b=this.createCustomButtons(a),b=b.add("\x3ch4\x3e"+a.title+"\x3c/h4\x3e"),d=jQuery("\x3cp/\x3e");a.hasOwnProperty("image")&&(null!=a.image&&""!=a.image)&&(d.append('\x3cdiv class\x3d"resultimage"\x3e\x3cimg src\x3d"'+a.image+'"\x3e\x3c/div\x3e'),d.addClass("minheight"));a.hasOwnProperty("description")&&null!=a.description&&d.append('\x3cdiv class\x3d"resultdescription"\x3e'+a.description+
"\x3c/div\x3e");if(a.hasOwnProperty("description")&&null!=a.description||a.hasOwnProperty("image")&&null!=a.image&&""!=a.image)b=b.add(d);return b};Septima.Search.createCustomButtons=function(a){for(var b=a.searcher.getCustomButtonDefs(a),d=jQuery(),c=0;c<b.length;c++)var e=this.createCustomButton(a,b[c]),d=d.add(e);return d};
Septima.Search.createCustomButton=function(a,b){var d=b.callBack;if(void 0==b.buttonImage){var c=jQuery('\x3cspan class\x3d"button"\x3e\x3c/span\x3e');c.append(b.buttonText)}else c=jQuery("\x3cimg class\x3d'custombutton' title\x3d'"+b.buttonText+"' src \x3d '"+b.buttonImage+"'\x3cimg\x3e");c.mousedown(Septima.bind(function(a,b,c){a=a(b);null!=a&&(void 0==a.buttonImage?(c.empty(),c.append(a.buttonText)):(c.attr("src",a.buttonImage),c.attr("title",a.buttonText)));return!1},this,d,a,c));return c};Septima.Search.Searcher=Septima.Class({_id:null,_onSelectCallback:null,attributesPropertyName:"attributes",customButtonDefs:null,onNewQueryHandlers:null,Searcher:function(a){this.customButtonDefs=[];this.onNewQueryHandlers=[];void 0!=a&&jQuery.isFunction(a.onSelect)&&(this._onSelectCallback=a.onSelect);this._id=this.CLASS_NAME+"_"+Math.floor(999999999*Math.random())},getId:function(){return this._id},createQueryResult:function(){return new Septima.Search.QueryResult(this)},fetchData:function(a,b){b.fetchError(this,
"Bad driver implementation for "+this.getId()+". Method fetchData MUST be implemented")},addNewQueryHandler:function(a){this.onNewQueryHandlers.push(a)},doNewQuery:function(a){for(var b=0;b<this.onNewQueryHandlers.length;b++)this.onNewQueryHandlers[b](a)},hasTarget:function(){return!1},getCustomButtonDefs:function(a){return a.newquery?[]:this.customButtonDefs},addCustomButtonDef:function(a){this.customButtonDefs.push(a)},onSelect:function(a){jQuery.isFunction(this._onSelectCallback)&&this._onSelectCallback(a)},
abort:function(){},CLASS_NAME:"Septima.Search"});Septima.Search.SQSearcher=Septima.Class(Septima.Search.Searcher,{spatialSuiteHost:null,layers:"",profile:"",profileQuery:"",buffer:"3",seek_all_themes:"false",initialize:function(a){this.Searcher(a);this.spatialSuiteHost=a.spatialSuiteHost;this.layers=a.layers;this.profile=a.profile;this.profileQuery=a.profileQuery;this.buffer=a.buffer;this.seek_all_themes=a.seek_all_themes},getCustomButtonDefs:function(a){return a.newquery?[]:this.customButtonDefs},fetchData:function(a,b){$.ajax({url:"http://"+this.spatialSuiteHost+
"/cbkort?cbinfo.output\x3djson\x26outputformat\x3djson",data:{wkt:a.geometry,page:"spatialquery-getresult",distance:this.buffer,layers:this.layers,profile:this.profile,profilequery:this.profileQuery,seek_all_themes:this.seek_all_themes},jsonp:"json.callback",dataType:"jsonp",cache:!1,timeout:1E4,crossDomain:!0,success:Septima.bind(function(a,b,e,g,f){e.query=b;this.success(a,e,g,f)},this,b,a),error:Septima.bind(function(a,b,e,g){this.error(a,b,e,g)},this,b)})},success:function(a,b,d,c){200==c.status?
a.fetchSuccess(this.transformSqResultToList(b)):a.fetchError(this,c.statusText)},error:function(a,b,d,c){a.fetchError(this,c)},transformSqResultToList:function(a){var b=this.createQueryResult();a=a.row[0].row[0].row;for(var d=0;d<a.length;d++)for(var c=a[d].row,e=c[0].overskrift,g=6;g<c.length;g++){var f=c[g].row,h=this.getHeading(f);b.addResult(h,e,null,f)}return b},getHeading:function(a){for(var b=0;b<a.length;b++)if("heading"==a[b].format)return a[b].value;return""},CLASS_NAME:"Septima.Search.SQSearcher"});Septima.Search.DummySearcher=Septima.Class(Septima.Search.Searcher,{errorCustomButtonDef:null,goodCustomButtonDef:null,initialize:function(a){this.Searcher(a);this.errorCustomButtonDef=[{buttonText:"Error",callBack:Septima.bind(this.errorClick,this)}];this.goodCustomButtonDef=[{buttonText:"Good",callBack:Septima.bind(this.errorClick,this)}]},errorClick:function(){return this.goodCustomButtonDef[0]},hasTarget:function(a){return"error"==a||"suggestions"==a||"long"==a?!0:!1},fetchData:function(a,b){var d=
a.queryString,c=this.createQueryResult();a.hasTarget?"error"==a.target?b.fetchError(this,"An error was thrown by the dummy driver [Error: 23]"):"suggestions"==a.target?(c.addSuggestion("error","error:"),c.addSuggestion("long","long:"),b.fetchSuccess(c)):"long"==a.target&&(c.addResult("Very long and annoying and irritating title from dummy driver","A very long description for a search result from the dummy driver. The purpose is to test how the UI reacts and looks",null,null).image="http://files.softicons.com/download/holidays-icons/desktop-halloween-icons-by-aha-soft/png/48x48/Scull.png",
c.addResult("Yet another very long and annoying and irritating title from dummy driver","Another very long description for a search result from the dummy driver. Again, the purpose is to test how the UI reacts and looks",null,null),b.fetchSuccess(c)):(0=="suggestions".indexOf(d)?c.addSuggestion("suggestions","suggestions:"):0=="error".indexOf(d)?c.addSuggestion("error","error:"):0=="long".indexOf(d)?c.addSuggestion("long","long:"):(c.addResult("DummyResult1","A dummy result returned for the purpose of testing",
null,null),c.addResult("DummyResult2","Another dummy result returned for the purpose of testing",null,null)),b.fetchSuccess(c))},getCustomButtonDefs:function(a){return a.newquery?[]:this.errorCustomButtonDef},CLASS_NAME:"Septima.Search.DummySearcher"});Septima.Search.AddressSearcher=Septima.Class(Septima.Search.Searcher,{initialize:function(a){if(void 0==a)throw"New Septima.Search.AddressSearcher(options): Options missing.";a.area&&(this.area=a.area);this.Searcher(a);this.apikey=a.apiKey;this.title=a.title;this.projection=a.projection;this.serviceUrl="http://find.spatialsuite.com/service/locations/3/";this.resource="detect"},fetchData:function(a,b){var d={apikey:this.apikey,limit:a.limit};this.area&&(d.area=this.area);d=jQuery.ajax({url:this.serviceUrl+
this.resource+"/json/"+a.queryString,data:d,jsonp:"callback",dataType:"jsonp",cache:!1,timeout:1E4,crossDomain:!0,success:Septima.bind(function(a,b,d,f){this.success(a,b,d,f)},this,b),error:Septima.bind(function(a,b,d,f){this.error(a,b,d,f)},this,b)});b.registerOnCancelHandler(Septima.bind(function(a){a&&4!=a.readystate&&a.abort()},this,d))},success:function(a,b,d,c){a.isActive()&&(200==c.status?"OK"==b.status?a.fetchSuccess(this.getDataFromSmartResult(b)):a.fetchError(this,b.message):a.fetchError(this,
c.statusText))},getDataFromSmartResult:function(a){for(var b=this.createQueryResult(),d=0;d<a.numHits;d++){var c=a.data[d];"streetNameType"==c.type?b.addNewQuery(c.presentationString,null,c.streetName+" \x3cselect\x3e1\x3c/select\x3e, "+c.postCodeIdentifier+" "+c.districtName,c.geometryWkt,c):b.addResult(c.presentationString,null,c.geometryWkt,c)}return b},error:function(a,b,d,c){a.fetchError(this,c)},CLASS_NAME:"Septima.Search.AddressSearcher"});Septima.Search.PlanSearcher=Septima.Class(Septima.Search.Searcher,{searchindexServiceUrl:"http://searchindex.septima.dk/",index:"lokalplaner_vedtaget",planFolderIconUri:null,planIconUri:null,pdfIconUri:null,fields:"plannavn plannr anvendelsegenerel planid wkt doklink geom_simplify_10".split(" "),filter:null,prettyOutput:!1,targets:{},initialize:function(a){this.Searcher(a);this.planFolderIconUri="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAARCAYAAAAyhueAAAAABmJLR0QACAAIAAjJ+yk0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3QQJDww2gq/RswAAAkFJREFUOMutlL9rVEEQxz/v8mLeMxoDCjE2donEFJZBEAt/xMLWSkFEEGuxjBa+SyorQQWxsBVEEP8Dg0Eb8VdAQjCCRo3kPDmTPHO7M2Nx793lXST+wC/sLjOzO/udmZ0NAKrdx41/RO/SQwDiOG7qSvwnpGlKmqYABGsNURRZbvhXxHFMmAuTN07ZkQv3fnuoXC6v042NjRXkAODxzdO2//wd4jjmV0zbHa11kttyXRzHMHXrjJmZiStbFEXWjiRJLEkS2whr7VEUWWhmmJ/AVNcxDIJWysfHxwtF2QglU8VMMbF1ISdJgplhZs3q/kkhg8nrJ23k7CCV2RpvpxZRr5h6RAUVhzqPSB0Rj7o64h0qDnEOrw5znlrQy7lrT1vVN1VMlI+va+w7MUHc2/9XT+jBpQPMzX4o6EIzxVRYrvwg7rmNqzkQwcRj6sF7VBSkjnoP4jEREE8pMCrvZqgy3OY0Y1pPPbbqMRVQaeU5u9RUQRVTy/YoYdxBV1jHhX1Fp2rC6lKd7u0hvq6guSMF85goqAeV5gX5nsr8MiudOwi39LdVX4RP09/YNdSDac5KshQolq0NWQjWMJ95Ps9C5x5WS5sLDVJSFRZmvrNzsAcsOyTaTEM+muFLIxozZe7lZxY3DTA6ergY/v33A1dG+r5e7r77hmoK6hwqHvH1bHVo/oy8R9Vj4ugiZaq6m5UOz7MnjwqNEkahvpqubrv64svWi+K19W9Zoxmac9YbBgQ0mA4cHObY0UMM7x0qMP0JVRLh2hKHlhsAAAAASUVORK5CYII\x3d";
this.planIconUri="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QACAAIAAjJ+yk0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QQJDwE40LmC+QAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAAy0lEQVQ4y62VMQ6DMAxFv1EGR116sB4pm8OJerAulcLmDq1RAiUEyJMYSJSv/2MbCD+YWXGBaZoIACgXTCmdEvPez6L0uj1OO7u/n4UgAAzoQEoJlq5L5Dy6O3IgxrhaCyEU77sOlyK5gO3ZWn6XYGZdIiIqIloj32dm3YxMNJvHOI5FAWoMW3clIlBVqOpcxUNFs8gWAUDxXI781TyO2xunWjP/ayNXO9DSk8s+7DJ6XQTNWYyxiH7JYQhhFdm1zmwr3b821OsXYHwAXVzIrkXtMiQAAAAASUVORK5CYII\x3d";
this.pdfIconUri="data:image/gif;base64,R0lGODlhEAAQALMPAPsICf+0tP+KiqcBAtygof/q6vxhYf/Y2IsBA+5UVfYSFcbGxoSEhAAAAP///////yH5BAEAAA8ALAAAAAAQABAAAARm8ElGq5X4Mcc7Z41EJCSpJIrygY+ZvgDCNXSDvikADN7SKIigcEDshSaeRMCI2XAKBkGh42t2BIGDIXuoIjlbgcCgMBiOGk5gO3UUAgT0Zn3wcLwag9J+l5vbdngMC4SFhoI1iYoRADs\x3d";this.addCustomButtonDef({buttonText:"Se plandokument",buttonImage:this.pdfIconUri,callBack:Septima.bind(this.openPlanDok,this)})},getCustomButtonDefs:function(a){return a.newquery?[]:this.customButtonDefs},openPlanDok:function(a){window.open(a.data["properties.doklink"],
"_blank")},hasTarget:function(a){return this.targets.hasOwnProperty(a)},createQueryString:function(a){for(var b=jQuery.trim(a.queryString);null!=b.match(/  /);)b=b.replace(/  /g," ");b=b.replace(/[^a-z\u00e6\u00f8\u00e50-9\ ]/gi,"");b=b.split(" ");b=b.join("* ")+"*";a={fields:this.fields,size:a.limit,query:{query_string:{fields:["plannavn^2.0","text^1.0","planid^3.0"],default_operator:"AND",query:b,lenient:!0}}};this.filter&&(a.filter={query:{term:this.filter}});return window.JSON.stringify(a)},fetchData:function(a,
b){null==a.geometry&&(this.request=jQuery.ajax({url:this.searchindexServiceUrl+this.index+"/_search?pretty\x3d"+this.prettyOutput,type:"GET",data:{source:this.createQueryString(a)},jsonp:"callback",dataType:"jsonp",cache:!1,timeout:a.timeout,crossDomain:!0,success:Septima.bind(function(a,b,e,g,f){e.query=b;this.success(a,e,g,f)},this,b,a),error:Septima.bind(function(a,b,e,g){this.error(a,b,e,g)},this,b)}))},success:function(a,b,d,c){200==c.status?a.fetchSuccess(this.parseResult(b)):a.fetchError(this,
c.statusText)},error:function(a,b,d,c){a.fetchError(this,c)},parseResult:function(a){var b=this.createQueryResult(),d=a.query,c=a.hits.total;if(!d.hasTarget)for(var e in this.targets)0==e.indexOf(d.queryString.toLowerCase())&&b.addSuggestion(this.targets[e].title,e+":");if(c<=d.limit||"list.force"==d.type)for(c=0;c<a.hits.hits.length;c++)e=a.hits.hits[c].fields,a.hits.hits[c].highlight&&(e._highlight=a.hits.hits[c].highlight),e=b.addResult(e["properties.plannavn"],"Plannummer "+e["properties.plannr"]+
" - "+e["properties.anvendelsegenerel"],e["properties.wkt"],e),"list"==d.type&&(e.image=this.planIconUri);else b.addNewQuery("Planer ("+c+")","Der er fundet "+c+" planer, der matcher \x3cem\x3e"+d.queryString+"\x3c/em\x3e",d.queryString,null,null,null).image=this.planFolderIconUri;return b},onSelect:function(a){a.newquery||this._onSelectCallback(a)},CLASS_NAME:"Septima.Search.PlanSearcher"});Septima.Search.PlanWfsSearcher=Septima.Class(Septima.Search.Searcher,{pdfUri:null,initialize:function(a){this.Searcher(a);this.pdfUri="data:image/gif;base64,R0lGODlhEAAQALMPAPsICf+0tP+KiqcBAtygof/q6vxhYf/Y2IsBA+5UVfYSFcbGxoSEhAAAAP///////yH5BAEAAA8ALAAAAAAQABAAAARm8ElGq5X4Mcc7Z41EJCSpJIrygY+ZvgDCNXSDvikADN7SKIigcEDshSaeRMCI2XAKBkGh42t2BIGDIXuoIjlbgcCgMBiOGk5gO3UUAgT0Zn3wcLwag9J+l5vbdngMC4SFhoI1iYoRADs\x3d";this.addCustomButtonDef({buttonText:"Se plandokument",buttonImage:this.pdfUri,callBack:Septima.bind(this.openPlanDok,
this)})},getCustomButtonDefs:function(a){return a.newquery?[]:this.customButtonDefs},openPlanDok:function(a){window.open(a.data["properties.doklink"],"_blank")},fetchData:function(a,b){var d=a.geometry,c="callback_"+Math.floor(99999999999*Math.random());jQuery.ajax({url:"http://geoservice.plansystem.dk/wfs?SERVICE\x3dWFS\x26VERSION\x3d1.1.0\x26SRSname\x3depsg:25832\x26REQUEST\x3dGetFeature\x26TYPENAME\x3dpdk:theme_pdk_lokalplan_vedtaget_v\x26CQL_FILTER\x3dCONTAINS(geometri,%20"+d+")\x26outputFormat\x3djson\x26maxfeatures\x3d100",
data:{MAXFEATURES:10,format_options:"callback:"+c,typename:this.typename,propertyname:this.propertyname},jsonp:!1,jsonpCallback:c,dataType:"jsonp",cache:!1,timeout:5E3,crossDomain:!0,success:Septima.bind(function(a,b,c,d,l){c.query=b;this.success(a,c,d,l)},this,b,a),error:Septima.bind(function(a,b,c,d){this.error(a,b,c,d)},this,b)})},success:function(a,b,d,c){200==c.status?a.fetchSuccess(this.transformWfsResultToList(b)):a.fetchError(this,c.statusText)},error:function(a,b,d,c){a.fetchError(this,c)},
transformWfsResultToList:function(a){for(var b=this.createQueryResult(),d=0;d<a.features.length;d++){var c=a.features[d];b.addResult(c.properties.plannavn,"Plannummer "+a.features[d].properties.plannr,null,c)}return b},CLASS_NAME:"Septima.Search.PlanWfsSearcher"});Septima.Search.GeoSearch=Septima.Class(Septima.Search.Searcher,{params:{},serviceUrl:"http://kortforsyningen.kms.dk/Geosearch?service\x3dGEO",resources:["adresser","stednavne"],targets:{Adresser:{title:"Adresser"},Matrikelnumre:{title:"Matrikelnumre"},Kommuner:{title:"Kommuner"},Opstillingskredse:{title:"Opstillingskredse"},Politikredse:{title:"Politikredse"},Postdistrikter:{title:"Postdistrikter"},Regioner:{title:"Regioner"},Retskredse:{title:"Retskredse"},Stednavne:{title:"Stednavne"}},initialize:function(a){this.Searcher(a);
this.params=a.params},fetchData:function(a,b){var d={resources:this.resources.join(","),search:a.queryString,limit:a.limit},d=Septima.extend(d,this.params);jQuery.ajax({url:this.serviceUrl,data:d,dataType:"jsonp",cache:!1,timeout:1E4,crossDomain:!0,success:Septima.bind(function(a,b,d,f){this.success(a,b,d,f)},this,b),error:Septima.bind(function(a,b,d,f){this.error(a,f)},this,b)})},success:function(a,b,d,c){200==c.status?a.fetchSuccess(this.parseResult(b)):a.fetchError(this,c.statusText)},error:function(a,
b){a.fetchError(this,b)},parseResult_old:function(a){for(var b=[],d=0;d<a.data.length;d++){var c=a.data[d],e={title:c.presentationString,searcher:this,_geometry:c.geometryWkt};e[this.attributesPropertyName]=c;"streetNameType"==c.type&&(e.newquery=c.streetName+" \x3cselect\x3e1\x3c/select\x3e, "+c.postCodeIdentifier+" "+c.districtName,e.targetTest=c.streetName);b.push(e)}return{results:b,suggestions:[]}},parseResult:function(a){for(var b=this.createQueryResult(),d=0;d<a.data.length;d++){var c=a.data[d];
"streetNameType"==c.type?b.addNewQuery(c.presentationString,null,c.streetName+" \x3cselect\x3e1\x3c/select\x3e, "+c.postCodeIdentifier+" "+c.districtName,c.geometryWkt,c):b.addResult(c.presentationString,null,c.geometryWkt,c)}return b},CLASS_NAME:"Septima.Search.GeoSearch"});Septima.Search.CVR_enhedSearcher=Septima.Class(Septima.Search.Searcher,{cvrIconUri:null,cvrFolderIconUri:null,serviceUrl:"http://searchindex.septima.dk/",index:"cvr_enheder",fields:"navn wkt adresse_officiel postdist_officiel postnr_officiel cvrnr".split(" "),filter:null,targets:{},initialize:function(a){this.Searcher(a);this.cvrIconUri="data:image/gif;base64,R0lGODlhFAATAOfSAIosOIosOYssOowtO4suO4suPI0vPo4yP44zP440QI80QI81QpA2QpA3Q5E3Q5A4RZE4RJE4RZE5RJI5RpE5SZI6RJM6RpI7RZI7SZM7R5I7SpM7SJQ7SZI8SJM8SJM8S5U8SZM9SZM9SpQ9SJQ9SZM9TJQ9SpQ9S5M+S5Q+SpQ+S5U+SZQ+TJU+SpU+S5U+TJQ/SpQ/S5Q/TJU/SpU/S5U/TJVATJVATZZAS5ZATZVBTJdBR5ZBS5ZBTJdBSpVCTZVCT5ZCTZdCTZhCS5dCTpdCT5dDT5dDUJhDUZhFUZlFUZhGUJhGUZtHSZpISJpIU5pJVJpKVJtKVZxLVZtLWZxMVp1OWJ1PWZ5RW59TXZ9TXqBTXKFTWqBUXqFWXqJWYKZYS6JYY6NYY6NZYqNZZKdfaa1hSa5iSKhha6dibKljbapkballb6plbqpmb6tnb6tncLJpSbJrUqtqcqxqc61rdLRtTbZuSq5sdrlySLlySrlzSbBxebp0R7p0SLt0SLp1SrJzfbJ0fbx2TLt2Ubx4Sr55SL98SrZ6g7Z7g8B+ScF+SsKBSsWESryFjbuGjb+MlMCNlMGPlcGPl8KSmcOTmsSWncaZn8aZoMicosmgpsqgpsqhpsyjqdCqsNGvs9KwtNW0uNi3vNe4vdi5vdi5vtm7vdm8wNvAxN7FyOLLzeLN0OPN0ePOz+PP0ePP0ubT1+fU1ufU1+jY2unZ2+nZ3Ora3Ovb3urc3erc3uvc3ezd3+ze4O3h4u7j5O/j4/Hm5/Hm6PLn6fLp6vLp7fHq6vXu7vXu7/fx8fj19/r19vv4+Pz5+vz7/f39/f7+/v7//v///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEKAP8ALAAAAAAUABMAAAj+AP8JHKirE5stXNJkmjWwYUM6PSZ0AGMGwwQVaHo5FIiLhAgXO5rsUeTER4wUB1Q59MXkBI0UjeL8MdSn0JAWMGDEakjGgwwVH87kuaPHzh0ULlqouDHwE4IXNaJSGLSI0SENL2jQiAFBksAxMmD8yGGkhBxAfggBMXIESZIYVv4Ng+IBkbFo0Ew1o1KC2K9ogIFJCVKLF5Eu0SIxCETpmKgv0cqsahBl2RoTpG5JwERLgI4JCRxFC3VJjSsYV4K1IeFplws+uQzAIAECCzJmYeBEe+bM1oYQoIA9ERON05tKmxakkpUCj6sNr4QxEQLrn5YRjwAr88IB0qQMdZJsBZhSzI0UgZYcWACgIEAKGBEezMhA4AYJAQ4SDSwiooaMGixoJWANLiTFQEOtrBCVDP/REFUNNKhAgwelOHRKATS4QMN/KrigAgs2DKDJRv+wksUFHeCkFQkVVDEKiQOhIsgSPOCgxBykbBQQADs\x3d";
this.cvrFolderIconUri="data:image/gif;base64,R0lGODlhFQARAOf+AIssOo0vPo4zP440QJA2QpA3Q5E3Q5E4RJE5RJI5RpE5SZI7SpM7SJM8SJU8SZQ9SZM9TJU+SpU+S5U+TJQ/SmVPNpQ/S5Q/TJU/S5U/TJZATZVBTJVCTZVCT5dCTpdDT5dDUJhDUZhFUZhGUZpJVJpKVHVXQptKVZtLWYZYIJ1PWZ5RW1tkb3BgWW9fa51cFqBUXqJWYJ9gF6JYY6RgEG9naW1oZqNZYmdqb21paW5paG5paW5qaW5qam9qam9qa5plJG9ra2dtdGdtdWltcmdudYNqTGhudmhud2hvd2lveHJubadfaWlweW9wcmlxemlxfGpxem5xc6ljbXZzb6dsJqpkbaVtI6plbqxtGqpmb6tncKZwKKhxKrJrUqhyLKxzL6N1Pqt2MK94NLBxea15Nbp0SLp1SrJzfbF7Obx2TLt2UbB8PK99OrR/Pr98SrKBP7Z6g6GEYMF+SrSEQ7aERMKBSrmHSLeISbuKTLyKTrmLTbyFjcCOL72MT72MWr6PUruQUsCQVcCSV8GSV8CNlMGTWKCWnsKTWcOUWsOVW8OVXsOWXMSWXsSXXsKSmcWXX8WZYMyZUsaaYMaaYcaZn8ifXsaZoMmgps6oZtGvs9i5ZdW0uOa+Sti3vNi5vtm7veLJbPDMT/HNUfHNU/HPVPLPU/LQVfLQVvLRV/PSV/LTWPPTWPPTWfXTVujUdPLUWuLN0PPVW/PWXOPP0fPWXfTYXvTZYPnZWPTbYfTbYvTbY/XcZPTdZPXeZfXeZ/bfZvXgafbgaOnZ2/bhaura3Pbia/bibPbjbOvb3vHkderc3vfkbPflbfflb+zd3/jlbvfmcOze4PfmcffocvjpcvjqdPnqdPjrdvnrdfnrdu/j4/nsd/ntd/ntefnuevruevHm5/Hm6Pnvevjwe/Ln6frwevrwfPrxffLp7fHq6vnzffLq6/r1gP72fvXu7vXu7/bv5vv4gv36g/fx8f77hf/9gvv4+Pz5+vz7/f39/f7+/v7//v///wAAAAAAACH5BAEKAP8ALAAAAAAVABEAAAj+AP8J/KdJwIQMCBWomWPnzYIJGDBYODCQ0Y0LFDho+ADByxkzazp8ABFChAWBkNiRaBDnXT9+oPKhgJBuW7+b4U78o9RPmgcY/QoRQPMInqcY/ZjEKlDinpV/keolQ3BpGIANCQbw6cep0hRaFFSIw/LP0bxnEsgsC0DhgYMV9PDN2NJvn75iDP4pkvdqUqNEgwDpuVPHTZoxYLpUCVNuxD9E7TLFu0m5MmU2KdRp+Udo3SJ76MBpqwbtGDBdtmSpcvXCBAAD/wSR++NuHDdr05gF63Wr1qpTuGi0iEDgHyBlls55y0atGTFfuWzBSmWqE5AaDT7987Mp1Dds1ZxnGfu1KzWrUqP6GHGBSWAeQ+a6XYuGTBivW7NaoSIlSoaTQwMRIYckgeyBBx1wtFGGGF9wcUUWFbAwkEBULPFDEEH44EMPPOywQw462ICDFBMOJMQQRRyBRBJKNNHEE1FAUeKMNNYYEAA7";
this.addCustomButtonDef({buttonText:"Se p\u00e5 cvr.dk",buttonImage:this.cvrIconUri,callBack:Septima.bind(this.openCvrLink,this)})},getCustomButtonDefs:function(a){return a.newquery?[]:this.customButtonDefs},openCvrLink:function(a){window.open("http://cvr.dk/Site/Forms/PublicService/DisplayCompany.aspx?cvrnr\x3d"+a.data["properties.cvrnr"],"_blank")},hasTarget:function(a){return this.targets.hasOwnProperty(a)},createQueryString:function(a){for(var b=jQuery.trim(a.queryString);null!=b.match(/  /);)b=
b.replace(/  /g," ");b=b.replace(/[^a-z\u00e6\u00f8\u00e50-9\ ]/gi,"");b=b.split(" ");b=b.join("* ")+"*";a={fields:this.fields,size:a.limit,query:{query_string:{default_field:"_all",default_operator:"AND",query:b,lenient:!0}}};this.filter&&(a.filter={query:{term:this.filter}});return window.JSON.stringify(a)},fetchData:function(a,b){this.request=jQuery.ajax({url:this.serviceUrl+this.index+"/_search?pretty\x3dtrue",type:"GET",data:{source:this.createQueryString(a)},jsonp:"callback",dataType:"jsonp",
cache:!1,timeout:a.timeout,crossDomain:!0,success:Septima.bind(function(a,b,e,g,f){e.query=b;this.success(a,e,g,f)},this,b,a),error:Septima.bind(function(a,b,e,g){this.error(a,b,e,g)},this,b)})},success:function(a,b,d,c){a.isActive()&&(200==c.status?a.fetchSuccess(this.parseResult(b)):a.fetchError(this,c.statusText))},error:function(a,b,d,c){a.fetchError(this,c)},parseResult:function(a){var b=this.createQueryResult(),d=a.query,c=a.hits.total;if(!d.hasTarget)for(var e in this.targets)0==e.indexOf(d.queryString.toLowerCase())&&
b.addSuggestion(this.targets[e].title,e+":");if(c<=d.limit||"list.force"==d.type)for(c=0;c<a.hits.hits.length;c++)e=a.hits.hits[c].fields,a.hits.hits[c].highlight&&(e._highlight=a.hits.hits[c].highlight),e=b.addResult(e["properties.navn"],e["properties.navn"]+", "+e["properties.postnr_officiel"]+" "+e["properties.postdist_officiel"],e["properties.wkt"],e),"list"==d.type&&(e.image=this.cvrIconUri);else b.addNewQuery("Virksomheder ("+c+")","Der er fundet "+c+" virksomheder, der matcher \x3cem\x3e"+
d.queryString+"\x3c/em\x3e",d.queryString,null,null,null).image=this.cvrFolderIconUri;return b},onSelect:function(a){a.newquery||this._onSelectCallback(a)},CLASS_NAME:"Septima.Search.CVR_enhedSearcher"});